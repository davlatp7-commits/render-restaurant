<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile.css') }}">
</head>
<body>
    <!-- Header -->
    <div class="waiter-header">
        <a href="{{ url_for('client.index') }}" class="back-button">‚Üê</a>
        <div class="cart-title">–ê–¥–º–∏–Ω</div>
        <div></div>
    </div>
    <!-- Top navigation for admin sections -->
    <div class="categories" style="padding-bottom: 0;">
        <a href="{{ url_for('admin.admin_panel') }}" class="category-tab active">–ë–ª—é–¥–∞</a>
        <a href="{{ url_for('admin.admin_orders') }}" class="category-tab">–ó–∞–∫–∞–∑—ã</a>
        <a href="{{ url_for('admin.orders_history') }}" class="category-tab">–ò—Å—Ç–æ—Ä–∏—è</a>
        <a href="{{ url_for('admin.manage_categories') }}" class="category-tab">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
    </div>

    <div style="padding: 12px;">
        <h2 style="font-size: 18px; margin-bottom: 12px;">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –±–ª—é–¥–æ</h2>
        <form class="add-dish" action="{{ url_for('admin.add_dish') }}" method="post" enctype="multipart/form-data">
            <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
            <textarea name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
            <input type="text" name="weight" placeholder="–í–µ—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä 300 –≥">
            <input type="number" step="0.01" name="price" placeholder="–¶–µ–Ω–∞, ‚ÇΩ" required>
            <select name="category_id">
                <option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                {% for cat in categories %}
                    <option value="{{ cat.id }}">{{ cat.name }}</option>
                {% endfor %}
            </select>
            <input type="file" name="image" accept="image/*">
            <button type="submit">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
        </form>

        <h2 style="font-size: 18px; margin-top: 20px; margin-bottom: 12px;">–°–ø–∏—Å–æ–∫ –±–ª—é–¥</h2>
        {% for dish in dishes %}
        <div class="admin-dish-card">
            {# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–ª—é–¥–∞. –°–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–µ image_url (—Å—Å—ã–ª–∫–∞ –Ω–∞ Cloudinary),
               –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ image_filename –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
               –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≤—ã–≤–æ–¥–∏–º –ª–æ–≥–æ—Ç–∏–ø –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. #}
            {% if dish.image_url %}
                <img class="admin-dish-image" src="{{ dish.image_url }}" alt="{{ dish.name }}">
            {% elif dish.image_filename %}
                {% if dish.image_filename.startswith('http') %}
                    <img class="admin-dish-image" src="{{ dish.image_filename }}" alt="{{ dish.name }}">
                {% else %}
                    <img class="admin-dish-image" src="{{ url_for('static', filename='img/' + dish.image_filename) }}" alt="{{ dish.name }}">
                {% endif %}
            {% else %}
                <!-- Fallback to logo when no image is available -->
                <img class="admin-dish-image" src="{{ url_for('static', filename='img/logo.png') }}" alt="{{ dish.name }}">
            {% endif %}
            <div class="admin-dish-details">
                <div class="admin-dish-name">{{ dish.name }}</div>
                <div class="admin-dish-desc">{{ dish.description }}</div>
                <div class="admin-dish-meta">
                    {% if dish.weight %}<span>{{ dish.weight }}</span>{% endif %}
                    <span>{{ '%.0f'|format(dish.price) }} ‚ÇΩ</span>
                    <span>{% if dish.category %}{{ dish.category.name }}{% else %}‚Äî{% endif %}</span>
                    <span>{{ '–î–∞' if dish.is_available else '–ù–µ—Ç' }}</span>
                </div>
                <div class="admin-dish-actions">
                    <a href="{{ url_for('admin.edit_dish', dish_id=dish.id) }}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    <a href="{{ url_for('admin.delete_dish', dish_id=dish.id) }}" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ?');">–£–¥–∞–ª–∏—Ç—å</a>
                    <a href="{{ url_for('admin.toggle_availability', dish_id=dish.id) }}">{{ '–°–∫—Ä—ã—Ç—å' if dish.is_available else '–ü–æ–∫–∞–∑–∞—Ç—å' }}</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Bottom navigation for admin -->
    <div class="navbar">
        <a href="{{ url_for('admin.admin_panel') }}" class="nav-item active">
            <div class="icon">üçΩÔ∏è</div>
            <div>–ë–ª—é–¥–∞</div>
        </a>
        <a href="{{ url_for('admin.admin_orders') }}" class="nav-item">
            <div class="icon">üìã</div>
            <div>–ó–∞–∫–∞–∑—ã</div>
        </a>
        <a href="{{ url_for('admin.manage_categories') }}" class="nav-item">
            <div class="icon">üóÇÔ∏è</div>
            <div>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
        </a>
    </div>
</body>
</html>